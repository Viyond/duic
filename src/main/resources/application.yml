#
# Copyright 2017-2019 the original author or authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

logging:
  level:
    root: info
    liquibase: error

spring:
  reactor:
    debug-agent:
      enabled: true
  jackson:
    default-property-inclusion: non_default
    date-format: yyyy-MM-dd'T'HH:mm:ss
    property-naming-strategy: SNAKE_CASE

#================================================================================#
# server.port 服务端口                                                           #
# server.address 服务绑定的IP                                                    #
#================================================================================#
server:
  port: 7777

duic:
  #================================================================================#
  # dbms 数据库类型，默认为 MongoDB。                                              #
  # 可选数据库类型有：                                                             #
  # - MySQL                                                                        #
  # - PostgreSQL                                                                   #
  # - MongoDB                                                                      #
  #================================================================================#
  dbms: ${spring.profiles.active:MongoDB}

  #================================================================================#
  # room-email 系统超级管理员登录邮箱。                                            #
  # 如果邮箱帐户在系统中不存在则在启动服务时自动创建管理员帐户信息。               #
  #================================================================================#
  root-email: kevinz@weghst.com

  #================================================================================#
  # room-password 对应 romm-email 帐户的登录密码。                                 #
  # 该密码只针对第一次创建帐户时有效，如果帐户已经存在则不会使用该密码配置。       #
  #================================================================================#
  root-password: 123456
  jwt:
    #================================================================================#
    # JWT 验证和加密所使用的密钥。                                                   #
    #================================================================================#
    secret: U2FsdGVkX1/jO0KlWumac4yDM8rOgWPkaV0KrSHDynWOP6n8FMJB9uSc8EW/qM+VagrMBAXGpyw=

    #================================================================================#
    # JWT 令牌过期时间（秒）。                                                       #
    #================================================================================#
    expires-in: 7200
  concurrent:
    #================================================================================#
    # 设置在 1 秒之内的最大请求数。                                                  #
    # 默认值为 -1 。                                                                 #
    # 如果值小于等于 0 时则表示不做任何限制。                                        #
    # 如果值设置为 5000 则表示在 1 秒内仅接受 5000 个请求。                          #
    #================================================================================#
    request-limit-for-period: -1

    #================================================================================#
    # 设置同时发送监控配置状态的最大请求数。                                         #
    # 默认值为 -1 。                                                                 #
    # 如果值小于等于 0 时则表示不做任何限制。                                        #
    # 如果值设置为 5000 则表示服务仅接受 5000 个监控状态请求，直到有请求完成时才会 \ #
    #   接受新的监控请求。                                                           #
    #================================================================================#
    watch-request-limit: -1

    #================================================================================#
    # 设置监控配置状态请求阀值比率。                                                 #
    # 默认值为 0.8 。                                                                #
    # 当监控配置状态请求达到阀值时，应用会产生警告信息需要及时跟进处理。             #
    # 假设 `duic.concurrent.watch-request-limit` 设置为 5000，那 5000 * 0.8 = 4000 \ #
    #   监控请求达到 4000 时应用就会产生警告信息。                                   #
    #================================================================================#
    warn-rate-threshold: 0.8
  app:
    watch:
      updated:
        #================================================================================#
        # 定期扫描数据库配置更新状态（毫秒）。                                           #
        #================================================================================#
        fixed-delay: 60000

      deleted:
        #================================================================================#
        # 定期扫描数据库被删除的配置，清理内存（毫秒）。                                 #
        #================================================================================#
        fixed-delay: 600000
